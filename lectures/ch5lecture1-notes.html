<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/sub-title-1.0.0/sub_title.js" defer="true"></script>
<link href="../site_libs/quarto-contrib/grid-subtitle-1.0.0/grid_subtitle.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/grid-subtitle-1.0.0/subtitle.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/grid-subtitle-1.0.0/footer.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.551">

  <title>Stat 24320 - Ch5 Lecture 1</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="theorem.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-tablet-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-tablet-chalkboard/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-tablet-chalkboard/font-awesome.min.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.46.0/min/vs/editor/editor.main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
  <style type="text/css">
  .monaco-editor pre {
    background-color: unset !important;
  }

  .qpyodide-editor-toolbar {
    width: 100%;
    display: flex;
    justify-content: space-between;
    box-sizing: border-box;
  }

  .qpyodide-editor-toolbar-left-buttons, .qpyodide-editor-toolbar-right-buttons {
    display: flex;
  }



  .qpyodide-non-interactive-loading-container.qpyodide-cell-needs-evaluation, .qpyodide-non-interactive-loading-container.qpyodide-cell-evaluated {
    justify-content: center;
    display: flex;
    background-color: rgba(250, 250, 250, 0.65);
    border: 1px solid rgba(233, 236, 239, 0.65);
    border-radius: 0.5rem;
    margin-top: 15px;
    margin-bottom: 15px;
  }

  .qpyodide-r-project-logo {
    color: #2767B0; /* R Project's blue color */
  }

  .qpyodide-icon-status-spinner {
    color: #7894c4;
  }

  .qpyodide-icon-run-code {
    color: #0d9c29
  }

  .qpyodide-output-code-stdout {
    color: #111;
  }

  .qpyodide-output-code-stderr {
    color: #db4133;
  }

  .qpyodide-editor {
    border: 1px solid #EEEEEE;
    text-align: left;
  }

  .qpyodide-editor-toolbar {
    background-color: #EEEEEE;
    padding: 0.2rem 0.5rem;
  }

  .qpyodide-button {
    background-color: #EEEEEE;
    display: inline-block;
    font-weight: 400;
    line-height: 1;
    text-decoration: none;
    text-align: center;
    color: #000;
    border-color: #dee2e6;
    border: 1px solid rgba(0,0,0,0);
    padding: 0.375rem 0.75rem;
    font-size: .9rem;
    border-radius: 0.25rem;
    transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
  }

  .qpyodide-button:hover {
    color: #000;
    background-color: #d9dce0;
    border-color: #c8ccd0;
  }

  .qpyodide-button:disabled,.qpyodide-button.disabled,fieldset:disabled .qpyodide-button {
    pointer-events: none;
    opacity: .65
  }

  .qpyodide-button-reset {
    color: #696969; /*#4682b4;*/
  }

  .qpyodide-button-copy {
    color: #696969;
  }


  /* Custom styling for RevealJS Presentations*/

  /* Reset the style of the interactive area */
  .reveal div.qpyodide-interactive-area {
    display: block;
    box-shadow: none;
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
  } 

  /* Provide space to entries */
  .reveal div.qpyodide-output-code-area pre div {
    margin: 1px 2px 1px 10px;
    text-align: left;
    padding-left: 10px;

  }

  /* Collapse the inside code tags to avoid extra space between line outputs */
  .reveal pre div code.qpyodide-output-code-stdout, .reveal pre div code.qpyodide-output-code-stderr {
    padding: 0;
    display: contents;

  }

  .qpyodide-outside-insertion-location {
      height: 90dvh;
      width: 90dvw;
      position: fixed;
      z-index: 100;
      /* top: 0px; */
      margin: 30px;
      border: black solid;
      background-color: white;
      /* scale: 1; */
      pointer-events: auto;
      display:none;
      overflow-y: scroll;
      scale: 1;
      font-size: 1rem;
    }

    .qpyodide-outside-insertion-location .qpyodide-interactive-area {
    /*  font-size: 12px!important;
      line-height: 14px!important; */
      scale: 1;
    }

  .qpyodide-outside-insertion-location .view-lines,
   .qpyodide-outside-insertion-location .margin-view-overlays, .qpyodide-outside-insertion-location .qpyodide-output-code-area  {
    font-size: inherit!important;
    line-height: inherit!important;
  }


    .qpyodide-output-graph-area {
      width: 80dvw;
    }



  .reveal pre div code.qpyodide-output-code-stdout {
    color: #111;

  }

  .reveal pre div code.qpyodide-output-code-stderr {
    color: #db4133;
  }


  /* Create a border around console and output (does not effect graphs) */
  .reveal div.qpyodide-console-area {
    border: 1px solid #251cc7;
    box-shadow: 2px 2px 10px #EEEEEE;
    background: white;
  }

  /* Cap output height and allow text to scroll */
  /* TODO: Is there a better way to fit contents/max it parallel to the monaco editor size? */
  .reveal div.qpyodide-output-code-area pre {
    max-height: 400px;
    min-height: 100px;
    overflow: scroll;
    font-size:1rem;
  }

  .slide {
    height:100%;
  }


  </style>
  <script type="module">
  // Document level settings ----

  // Determine if we need to install python packages
  globalThis.qpyodideInstallPythonPackagesList = [''];

  // Check to see if we have an empty array, if we do set to skip the installation.
  globalThis.qpyodideSetupPythonPackages = !(qpyodideInstallPythonPackagesList.indexOf("") !== -1);

  // Display a startup message?
  globalThis.qpyodideShowStartupMessage = true;

  // Describe the webR settings that should be used
  globalThis.qpyodideCustomizedPyodideOptions = {
    "indexURL": "https://cdn.jsdelivr.net/pyodide/v0.25.0/full/",
    "env": {
      "HOME": "/home/pyodide",
    }, 
    stdout: (text) => {qpyodideAddToOutputArray(text, "out");},
    stderr: (text) => {qpyodideAddToOutputArray(text, "error");}
  }

  // Store cell data
  globalThis.qpyodideCellDetails = [{"id":1,"options":{"message":"true","read-only":"false","dpi":72,"classes":"","fig-width":7,"warning":"true","context":"interactive","output":"true","comment":"","out-height":"","fig-cap":"","fig-height":5,"autorun":"","results":"markup","out-width":"700px","label":""},"code":"import matplotlib.pyplot as plt\nimport numpy as np\ndef plot_iterations(x0, A, n1=10, n2=1):\n  plt.clf()\n  x = x0\n  x_vals = [x]\n  for i in range(n1):\n    for j in range(n2):\n      x = A @ x\n    x_vals.append(x)\n  x_vals = np.array(x_vals)\n  plt.plot(x_vals[:,0], x_vals[:,1], 'o-',)\n  for i, txt in enumerate(range(len(x_vals))):\n    plt.annotate(txt, (x_vals[i,0]+1, x_vals[i,1]+1))\n  #plt.plot(x_vals[:,0], x_vals[:,1], 'o-')\n  plt.xlabel('B')\n  plt.ylabel('F')\n  plt.title('Population dynamics: eigenvalues='+str(np.linalg.eig(A)[0]))\n  plt.show()"},{"id":2,"options":{"message":"true","read-only":"false","dpi":72,"classes":"","fig-width":7,"warning":"true","context":"interactive","output":"true","comment":"","out-height":"","fig-cap":"","fig-height":5,"autorun":"","results":"markup","out-width":"700px","label":""},"code":"A = np.array([[0, 2], [-2, 0]])\nplot_iterations(np.array([1,2]), A)"}];


  </script>
  <script type="module">
  // Declare startupMessageqpyodide globally
  globalThis.qpyodideStartupMessage = document.createElement("p");

  // Function to set the button text
  globalThis.qpyodideSetInteractiveButtonState = function(buttonText, enableCodeButton = true) {
    document.querySelectorAll(".qpyodide-button-run").forEach((btn) => {
      btn.innerHTML = buttonText;
      btn.disabled = !enableCodeButton;
    });
  }

  // Function to update the status message in non-interactive cells
  globalThis.qpyodideUpdateStatusMessage = function(message) {
    document.querySelectorAll(".qpyodide-status-text.qpyodide-cell-needs-evaluation").forEach((elem) => {
      elem.innerText = message;
    });
  }

  // Function to update the status message
  globalThis.qpyodideUpdateStatusHeader = function(message) {

    if (!qpyodideShowStartupMessage) return;

    qpyodideStartupMessage.innerHTML = message;
  }

  // Status header update with customized spinner message
  globalThis.qpyodideUpdateStatusHeaderSpinner = function(message) {

    qpyodideUpdateStatusHeader(`
      <i class="fa-solid fa-spinner fa-spin qpyodide-icon-status-spinner"></i>
      <span>${message}</span>
    `);
  }


  // Function that attaches the document status message
  function qpyodideDisplayStartupMessage(showStartupMessage) {
    if (!showStartupMessage) {
      return;
    }

    // Get references to header elements
    const headerHTML = document.getElementById("title-block-header");
    const headerRevealJS = document.getElementById("title-slide");

    // Create the outermost div element for metadata
    const quartoTitleMeta = document.createElement("div");
    quartoTitleMeta.classList.add("quarto-title-meta");

    // Create the first inner div element
    const firstInnerDiv = document.createElement("div");
    firstInnerDiv.setAttribute("id", "qpyodide-status-message-area");

    // Create the second inner div element for "Pyodide Status" heading and contents
    const secondInnerDiv = document.createElement("div");
    secondInnerDiv.setAttribute("id", "qpyodide-status-message-title");
    secondInnerDiv.classList.add("quarto-title-meta-heading");
    secondInnerDiv.innerText = "Pyodide Status";

    // Create another inner div for contents
    const secondInnerDivContents = document.createElement("div");
    secondInnerDivContents.setAttribute("id", "qpyodide-status-message-body");
    secondInnerDivContents.classList.add("quarto-title-meta-contents");

    // Describe the Pyodide state
    qpyodideStartupMessage.innerText = "🟡 Loading...";
    qpyodideStartupMessage.setAttribute("id", "qpyodide-status-message-text");
    // Add `aria-live` to auto-announce the startup status to screen readers
    qpyodideStartupMessage.setAttribute("aria-live", "assertive");

    // Append the startup message to the contents
    secondInnerDivContents.appendChild(qpyodideStartupMessage);

    // Combine the inner divs and contents
    firstInnerDiv.appendChild(secondInnerDiv);
    firstInnerDiv.appendChild(secondInnerDivContents);
    quartoTitleMeta.appendChild(firstInnerDiv);

    // Determine where to insert the quartoTitleMeta element
    if (headerHTML || headerRevealJS) {
      // Append to the existing "title-block-header" element or "title-slide" div
      (headerHTML || headerRevealJS).appendChild(quartoTitleMeta);
    } else {
      // If neither headerHTML nor headerRevealJS is found, insert after "Pyodide-monaco-editor-init" script
      const monacoScript = document.getElementById("qpyodide-monaco-editor-init");
      const header = document.createElement("header");
      header.setAttribute("id", "title-block-header");
      header.appendChild(quartoTitleMeta);
      monacoScript.after(header);
    }
  }

  qpyodideDisplayStartupMessage(qpyodideShowStartupMessage);
  </script>
  <script type="module">
  // Create a logging setup
  globalThis.qpyodideMessageArray = []

  // Add messages to array
  globalThis.qpyodideAddToOutputArray = function(message, type) {
    qpyodideMessageArray.push({ message, type });
  }

  // Function to reset the output array
  globalThis.qpyodideResetOutputArray = function() {
    qpyodideMessageArray = [];
  }

  globalThis.qpyodideRetrieveOutput = function() {
    return qpyodideMessageArray.map(entry => entry.message).join('\n');
  }

  // Start a timer
  const initializePyodideTimerStart = performance.now();

  // Encase with a dynamic import statement
  globalThis.qpyodideInstance = await import(
    qpyodideCustomizedPyodideOptions.indexURL + "pyodide.mjs").then(
     async({ loadPyodide }) => {

      console.log("Start loading Pyodide");
      
      // Populate Pyodide options with defaults or new values based on `pyodide`` meta
      let mainPyodide = await loadPyodide(
        qpyodideCustomizedPyodideOptions
      );
      
      // Setup a namespace for global scoping
      // await loadedPyodide.runPythonAsync("globalScope = {}"); 
      
      // Update status to reflect the next stage of the procedure
      qpyodideUpdateStatusHeaderSpinner("Initializing Python Packages");

      // Load the `micropip` package to allow installation of packages.
      await mainPyodide.loadPackage("micropip");
      await mainPyodide.runPythonAsync(`import micropip`);

      // Load the `pyodide_http` package to shim uses of `requests` and `urllib3`.
      // This allows for `pd.read_csv(url)` to work flawlessly.
      // Details: https://github.com/coatless-quarto/pyodide/issues/9
      await mainPyodide.loadPackage("pyodide_http");
      await mainPyodide.runPythonAsync(`
      import pyodide_http
      pyodide_http.patch_all()  # Patch all libraries
      `);

      // Load the `matplotlib` package with necessary environment hook
      await mainPyodide.loadPackage("matplotlib");

      // Set the backend for matplotlib to be interactive.
      await mainPyodide.runPythonAsync(`
      import matplotlib
      matplotlib.use("module://matplotlib_pyodide.html5_canvas_backend")
      from matplotlib import pyplot as plt
      `);

      // Unlock interactive buttons
      qpyodideSetInteractiveButtonState(
        `<i class="fa-solid fa-play qpyodide-icon-run-code"></i> <span>Run Code</span>`, 
        true
      );

      // Set document status to viable
      qpyodideUpdateStatusHeader(
        "🟢 Ready!"
      );

      // Assign Pyodide into the global environment
      globalThis.mainPyodide = mainPyodide;

      console.log("Completed loading Pyodide");
      return mainPyodide;
    }
  );

  // Stop timer
  const initializePyodideTimerEnd = performance.now();

  // Create a function to retrieve the promise object.
  globalThis._qpyodideGetInstance = function() {
      return qpyodideInstance;
  }

  </script>
</head>
<body class="quarto-light">
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.46.0/min/vs/loader.js"></script>
<script type="module" id="qpyodide-monaco-editor-init">

  // Configure the Monaco Editor's loader
  require.config({
    paths: {
      'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.46.0/min/vs'
    }
  });
</script>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Ch5 Lecture 1</h1>

<div class="quarto-title-authors">
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Outline for today</h2>
<ul>
<li class="fragment"><a href="#/eigenvalues-and-eigenvectors" id="/toc-eigenvalues-and-eigenvectors"><em>Eigenvalues and Eigenvectors</em></a></li>
<li class="fragment"><a href="#/similarity-and-diagonalization" id="/toc-similarity-and-diagonalization"><em>Similarity and Diagonalization</em></a></li>
<li class="fragment"><a href="#/application-to-discrete-dynamical-systems" id="/toc-application-to-discrete-dynamical-systems"><em>Application to Discrete Dynamical Systems</em></a></li>
</ul>
</nav>
</section>
<section>
<section id="eigenvalues-and-eigenvectors" class="title-slide slide level1 center">
<h1><em>Eigenvalues and Eigenvectors</em></h1>

</section>
<section id="eigenvalues-and-eigenvectors-1" class="title-slide slide level2 center">
<h2><em>Eigenvalues and Eigenvectors</em></h2>
<div class="definition">
<p>An <strong>eigenvector</strong> of <span class="math inline">\(A\)</span> is a nonzero vector <span class="math inline">\(\mathbf{x}\)</span> in <span class="math inline">\(\mathbb{R}^{n}\)</span> (or <span class="math inline">\(\mathbb{C}^{n}\)</span>) such that for some scalar <span class="math inline">\(\lambda\)</span>, we have</p>
<p><span class="math display">\[
A \mathbf{x}=\lambda \mathbf{x}
\]</span></p>
</div>
<div class="fragment">
<p>Why do we care? One reason: matrix multiplication can become <em>scalar</em> multiplication:</p>
<p><span class="math display">\[
\begin{aligned}
A \mathbf{x} &amp; =\lambda \mathbf{x} \\
A^{2} \mathbf{x} &amp; =A(A \mathbf{x})=A \lambda \mathbf{x}=\lambda A \mathbf{x}=\lambda^{2} \mathbf{x} \\
&amp; \vdots \\
A^{k} \mathbf{x} &amp; =A\left(A^{k-1} \mathbf{x}\right)=\cdots=\lambda^{k} \mathbf{x} .
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>Will see how to use these ideas to understand dynamics even for vectors that aren’t eigenvectors.</p>
</div>
</section>

<section id="finding-eigenvalues-and-eigenvectors" class="title-slide slide level2 center">
<h2><em>Finding Eigenvalues and Eigenvectors</em></h2>
<p><span class="math inline">\(\lambda\)</span> is an eigenvalue of <span class="math inline">\(A\)</span> if <span class="math inline">\(A \mathbf{x}=\lambda \mathbf{x}\left(=\lambda I \mathbf{x}\right)\)</span></p>
<div class="fragment">
<p><span class="math display">\[
\mathbf{0}=\lambda I \mathbf{x}-A \mathbf{x}=(\lambda I-A) \mathbf{x}
\]</span></p>
</div>
<div class="fragment">
<p><em>pause</em></p>
<aside class="notes">
<p>Remember a system of equations <span class="math inline">\(A \mathbf{x}=0\)</span> has a non-trivial solution if and only if <span class="math inline">\(A\)</span> is singular, or in other words <span class="math inline">\(\operatorname{det}(A)=0\)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<div class="fragment">
<p>So, <span class="math inline">\(\lambda\)</span> is an eigenvalue of <span class="math inline">\(A\)</span> <span class="math inline">\(\iff\)</span> <span class="math inline">\(\operatorname{det}(\lambda I-A)=0\)</span>.</p>
</div>
<div class="fragment">
<div class="definition">
<p>If <span class="math inline">\(A\)</span> is a square <span class="math inline">\(n \times n\)</span> matrix, the equation <span class="math inline">\(\operatorname{det}(\lambda I-A)=0\)</span> is called the <strong>characteristic equation</strong> of <span class="math inline">\(A\)</span>, and the <span class="math inline">\(n\)</span> th-degree monic polynomial <span class="math inline">\(p(\lambda)=\operatorname{det}(\lambda I-A)\)</span> is called the <strong>characteristic polynomial</strong> of <span class="math inline">\(A\)</span>.</p>
</div>
</div>
</section>

<section id="eigenspaces-and-eigensystems" class="title-slide slide level2 center">
<h2><em>Eigenspaces and Eigensystems</em></h2>
<div class="definition">
<p>The <strong>eigenspace</strong> corresponding to eigenvalue <span class="math inline">\(\lambda\)</span> is the subspace <span class="math inline">\(\mathcal{N}(\lambda I-A)\)</span> of <span class="math inline">\(\mathbb{R}^{n}\)</span> (or <span class="math inline">\(\left.\mathbb{C}^{n}\right)\)</span>.</p>
<p>We write <span class="math inline">\(\mathcal{E}_{\lambda}(A)=\mathcal{N}(\lambda I-A)\)</span>.</p>
</div>
<div class="fragment">
<p>Note: <span class="math inline">\(\mathbf{0}\)</span> is in every eigenspace, but it is not an eigenvector.</p>
</div>
<div class="fragment">
<div class="definition">
<p>The <strong>eigensystem</strong> of the matrix <span class="math inline">\(A\)</span> is a list of all the eigenvalues of <span class="math inline">\(A\)</span> and, for each eigenvalue <span class="math inline">\(\lambda\)</span>, a complete description of its eigenspace – usually a basis.</p>
</div>
</div>
<div class="fragment">
<div class="theorem">
<p>Eigensystem Algorithm:</p>
<p>Given <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span>, to find an eigensystem for <span class="math inline">\(A\)</span> :</p>
<ol type="1">
<li class="fragment"><p>Find the eigenvalues of <span class="math inline">\(A\)</span>.</p></li>
<li class="fragment"><p>For each scalar <span class="math inline">\(\lambda\)</span> in (1), use the null space algorithm to find a basis of the eigenspace <span class="math inline">\(\mathcal{N}(\lambda I-A)\)</span>.</p></li>
</ol>
</div>
</div>
</section>

<section id="a-reminder-the-null-space-algorithm" class="title-slide slide level2 center">
<h2><em>A reminder: the Null Space algorithm</em></h2>
<p>Given an <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\(A\)</span>.</p>
<ol type="1">
<li class="fragment"><p>Compute the reduced row echelon form <span class="math inline">\(R\)</span> of <span class="math inline">\(A\)</span>.</p></li>
<li class="fragment"><p>Use <span class="math inline">\(R\)</span> to find the general solution to the homogeneous system <span class="math inline">\(A \mathbf{x}=0\)</span>.</p></li>
</ol>
<div class="fragment">
<ol start="3" type="1">
<li class="fragment">Write the general solution <span class="math inline">\(\mathbf{x}=\left(x_{1}, x_{2}, \ldots, x_{n}\right)\)</span> to the homogeneous system in the form</li>
</ol>
</div>
<div class="fragment">
<p><span class="math display">\[
\mathbf{x}=x_{i_{1}} \mathbf{w}_{1}+x_{i_{2}} \mathbf{w}_{2}+\cdots+x_{i_{n-r}} \mathbf{w}_{n-r}
\]</span></p>
<p>where <span class="math inline">\(x_{i_{1}}, x_{i_{2}}, \ldots, x_{i_{n-r}}\)</span> are the free variables.</p>
</div>
<div class="fragment">
<ol start="4" type="1">
<li class="fragment">List the vectors <span class="math inline">\(\mathbf{w}_{1}, \mathbf{w}_{2}, \ldots, \mathbf{w}_{n-r}\)</span>. These form a basis of <span class="math inline">\(\mathcal{N}(A)\)</span>.</li>
</ol>
</div>
</section>

<section id="example-of-the-null-space-algorithm" class="title-slide slide level2 center">
<h2><em>Example of the Null Space algorithm</em></h2>
<p>Find a basis for the null space of the matrix <span class="math display">\[A=\left[\begin{array}{llll}
1 &amp; 0 &amp; 1 &amp; 2 \\
1 &amp; 2 &amp; 0 &amp; 1 \\
3 &amp; 2 &amp; 2 &amp; 5 \\
3 &amp; 4 &amp; 1 &amp; 4
\end{array}\right]
\]</span></p>
<div class="fragment">
<p>The reduced row echelon form of <span class="math inline">\(A\)</span> is</p>
<p><span class="math display">\[
R=\left[\begin{array}{rrrr}
1 &amp; 0 &amp; 1 &amp; 2 \\
0 &amp; 1 &amp; -1 / 2 &amp; -1 / 2 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]
\]</span></p>
<div class="fillin">

</div>
<aside class="notes">
<p>The variables <span class="math inline">\(x_{3}\)</span> and <span class="math inline">\(x_{4}\)</span> are free, while <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(x_{2}\)</span> are bound.</p>
<p>Hence, the general solution of <span class="math inline">\(A \mathbf{x}=0\)</span> can be written as</p>
<p><span class="math display">\[
\begin{aligned}
x_{1} &amp; =-x_{3}-2 x_{4}, \\
x_{2} &amp; =\frac{1}{2} x_{3}+\frac{1}{2} x_{4}, \\
x_{3} &amp; =x_{3}, \\
x_{4} &amp; =x_{4},
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4}
\end{array}\right]=x_{3}\left[\begin{array}{r}
-1 \\
1 / 2 \\
1 \\
0
\end{array}\right]+x_{4}\left[\begin{array}{r}
-2 \\
1 / 2 \\
0 \\
1
\end{array}\right] .
\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p>which becomes, in vector notation,</p>
<p><span class="math display">\[
\left[\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4}
\end{array}\right]=x_{3}\left[\begin{array}{r}
-1 \\
1 / 2 \\
1 \\
0
\end{array}\right]+x_{4}\left[\begin{array}{r}
-2 \\
1 / 2 \\
0 \\
1
\end{array}\right] .
\]</span></p>
<p>:::</p>
</div>
</section>

<section id="example" class="title-slide slide level2 center">
<h2><em>Example</em></h2>
<p>Find an eigensystem for the matrix <span class="math inline">\(A=\left[\begin{array}{ll}7 &amp; 4 \\ 3 &amp; 6\end{array}\right]\)</span></p>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
0 &amp; =\operatorname{det}(\lambda I-A)=\operatorname{det}\left[\begin{array}{rr}
\lambda-7 &amp; -4 \\
-3 &amp; \lambda-6
\end{array}\right] \\
&amp; =(\lambda-7)(\lambda-6)-(-3)(-4) \\
&amp; =\lambda^{2}-13 \lambda+42-12 \\
&amp; =\lambda^{2}-13 \lambda+30 \\
&amp; =(\lambda-3)(\lambda-10) .
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>Eigenvalues are <span class="math inline">\(\lambda=3\)</span> and <span class="math inline">\(\lambda=10\)</span>.</p>
</div>
<div class="fragment">
<p>For <span class="math inline">\(\lambda=3\)</span>, we have</p>
<p><span class="math display">\[
A-3 I=\left[\begin{array}{rr}
7-3 &amp; 4 \\
3 &amp; 3-3
\end{array}\right] =  {\left[\begin{array}{ll}
4 &amp; 4 \\
3 &amp; 3
\end{array}\right] \xrightarrow[E_{21}(-3 / 4)]{E_{1}(1 / 4)}\left[\begin{array}{ll}
1 &amp; 1 \\
0 &amp; 0
\end{array}\right]}
\]</span></p>
</div>
<div class="fragment">
<div class="pause">

</div>
<aside class="notes">
<p>So <span class="math inline">\(x_{2}\)</span> is free and <span class="math inline">\(x_{1}\)</span> is bound, <span class="math inline">\(x_{1}=-x_{2}\)</span>,so</p>
<p><span class="math display">\[
\left[\begin{array}{l}
x_{1} \\
x_{2}
\end{array}\right]=\left[\begin{array}{c}
-x_{2} \\
x_{2}
\end{array}\right]=x_{2}\left[\begin{array}{r}
-1 \\
1
\end{array}\right]
\]</span></p>
<p>so the eigenspace is spanned by <span class="math inline">\(\left[\begin{array}{l}1 \\ -1\end{array}\right]\)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<div class="fragment">
<p>Thus, a basis of <span class="math inline">\(\mathcal{E}_{3}(A)\)</span> is <span class="math inline">\(\{(-1,1)\}\)</span>.</p>
</div>
<div class="fragment">
<p>Similarly, for <span class="math inline">\(\lambda=10\)</span>, the basis of <span class="math inline">\(\mathcal{E}_{10}(A)\)</span> is <span class="math inline">\(\{(4 / 3,1)\}\)</span></p>
</div>
</section>

<section id="two-examples-with-repeated-eigenvalues" class="title-slide slide level2 center">
<h2><em>Two examples with repeated eigenvalues</em></h2>
<p>What happens when an eigenvalue is repeated?</p>
<p>Example: find the eigenspace for eigenvalue <span class="math inline">\(\lambda=2\)</span> of these two matrices:</p>
<p><span class="math display">\[
\text { (a) }\left[\begin{array}{rrr}
2 &amp; 1 &amp; 2 \\
0 &amp; 1 &amp; -2 \\
0 &amp; 0 &amp; 2
\end{array}\right] \quad \text { (b) }\left[\begin{array}{lll}
2 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 2
\end{array}\right]
\]</span></p>
<div class="fragment">
<p>Both matrices have eigenvalues <span class="math inline">\(\lambda=1,2,2\)</span>, but their eigenspaces for <span class="math inline">\(\lambda=2\)</span> are different:</p>
</div>
<div class="fragment">
<p>After row reducing the first matrix, we get</p>
<p><span class="math display">\[
\left[\begin{array}{rrr}
0 &amp; 1 &amp; 2 \\
0 &amp; -1 &amp; -2 \\
0 &amp; 0 &amp; 0
\end{array}\right] \xrightarrow[E_{21}(1)]{\longrightarrow}\left[\begin{array}{lll}
0 &amp; 1 &amp; 2 \\
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0
\end{array}\right]
\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
\left[\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right]=\left[\begin{array}{c}
x_{1} \\
-2 x_{3} \\
x_{3}
\end{array}\right]=x_{1}\left[\begin{array}{l}
1 \\
0 \\
0
\end{array}\right]+x_{3}\left[\begin{array}{r}
0 \\
-2 \\
1
\end{array}\right] .
\]</span></p>
</div>
<div class="fragment">
<p>A basis for <span class="math inline">\(\mathcal{E}_{2}(A)\)</span> is <span class="math inline">\(\{(1,0,0),(0,-2,1)\}\)</span>.</p>
<p>Dimension of <span class="math inline">\(\mathcal{E}_{2}(A)=2\)</span>.</p>
</div>
</section>

<section id="section" class="title-slide slide level2 center">
<h2><em></em></h2>
<p><span class="math display">\[
\text { (a) }\left[\begin{array}{rrr}
2 &amp; 1 &amp; 2 \\
0 &amp; 1 &amp; -2 \\
0 &amp; 0 &amp; 2
\end{array}\right] \quad \text { (b) }\left[\begin{array}{lll}
2 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 2
\end{array}\right]
\]</span></p>
<p>For the second matrix, we have <span class="math display">\[
\left[\begin{array}{rrr}
0 &amp; 1 &amp; 1 \\
0 &amp; -1 &amp; 1 \\
0 &amp; 0 &amp; 0
\end{array}\right] \xrightarrow[E_{21}(1)]{\longrightarrow}\left[\begin{array}{lll}
0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 2 \\
0 &amp; 0 &amp; 0
\end{array}\right] \xrightarrow{E_{2}(1 / 2)}\left[\begin{array}{lll}
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0
\end{array}\right]
\]</span></p>
<div class="fragment">
<p>Only free variable is <span class="math inline">\(x_{1}\)</span>, so</p>
<p><span class="math display">\[
\left[\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right]=\left[\begin{array}{c}
x_{1} \\
0 \\
0
\end{array}\right]=x_{1}\left[\begin{array}{l}
1 \\
0 \\
0
\end{array}\right]
\]</span></p>
</div>
<div class="fragment">
<p>A basis for <span class="math inline">\(\mathcal{E}_{2}(A)\)</span> is <span class="math inline">\(\{(1,0,0)\}\)</span>. Dimension of <span class="math inline">\(\mathcal{E}_{2}(A)=1\)</span>.</p>
</div>
</section>

<section id="eigenvalue-multiplicity" class="title-slide slide level2 center">
<h2><em>Eigenvalue Multiplicity</em></h2>
<div class="definition">
<p>The <strong>algebraic multiplicity</strong> of <span class="math inline">\(\lambda\)</span> is the multiplicity of <span class="math inline">\(\lambda\)</span> as a root of the characteristic equation. The <strong>geometric multiplicity</strong> of <span class="math inline">\(\lambda\)</span> is the dimension of the space <span class="math inline">\(\mathcal{E}_{\lambda}(A)=\mathcal{N}(\lambda I-A)\)</span>.</p>
</div>
<div class="fragment">
<div class="definition">
<p>The eigenvalue <span class="math inline">\(\lambda\)</span> of <span class="math inline">\(A\)</span> is said to be <strong>simple</strong> if its algebraic multiplicity is 1 , that is, the number of times it occurs as a root of the characteristic equation is 1 . Otherwise, the eigenvalue is said to be <strong>repeated</strong>.</p>
</div>
</div>
<div class="fragment">
<div class="theorem">
<p>For an <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span>, the sum of the algebraic multiplicities of all the eigenvalues of <span class="math inline">\(A\)</span> is <span class="math inline">\(n\)</span>.</p>
<div class="fragment">
<p>(In other words, there are <span class="math inline">\(n\)</span> eigenvalues, counting algebraic multiplicities and complex numbers).</p>
</div>
<div class="fragment">
<p>The <em>geometric multiplicity</em> of an eigenvalue is always less than or equal to its <em>algebraic multiplicity</em>.</p>
</div>
</div>
</div>
</section>

<section id="defective-matrices" class="title-slide slide level2 center">
<h2><em>Defective Matrices</em></h2>
<div class="definition">
<p>A matrix is <strong>defective</strong> if one of its eigenvalues has geometric multiplicity less than its algebraic multiplicity.</p>
</div>
<div class="fragment">
<p>This means that the sum of the geometric multiplicities of all the eigenvalues is less than <span class="math inline">\(n\)</span>.</p>
</div>
</section>
</section>
<section>
<section id="similarity-and-diagonalization" class="title-slide slide level1 center">
<h1><em>Similarity and Diagonalization</em></h1>

</section>
<section id="functions-of-diagonal-matrices" class="title-slide slide level2 center">
<h2><em>Functions of Diagonal Matrices</em></h2>
<p>It’s easy to find functions of matrices if the matrix is <strong>diagonal</strong>.</p>
<p><span class="math display">\[
D = \operatorname{diag}\left\{\lambda_{1}, \lambda_{2}, \lambda_{3}\right\}=\left[\begin{array}{ccc}
\lambda_{1} &amp; 0 &amp; 0 \\
0 &amp; \lambda_{2} &amp; 0 \\
0 &amp; 0 &amp; \lambda_{3}
\end{array}\right]
\]</span></p>
<div class="fragment">
<p><span class="math inline">\(D^{k}=\operatorname{diag}\left\{\lambda_{1}^{k}, \lambda_{2}^{k}, \ldots, \lambda_{n}^{k}\right\}\)</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
f(D)=\operatorname{diag}\left\{f\left(\lambda_{1}\right), f\left(\lambda_{2}\right), \ldots, f\left(\lambda_{n}\right)\right\}
\]</span></p>
</div>
</section>

<section id="similar-matrices" class="title-slide slide level2 center">
<h2><em>Similar Matrices</em></h2>
<div class="definition">
<p>A matrix <span class="math inline">\(A\)</span> is said to be <strong>similar</strong> to matrix <span class="math inline">\(B\)</span> if there exists an invertible matrix <span class="math inline">\(P\)</span> such that</p>
<p><span class="math display">\[
P^{-1} A P=B .
\]</span></p>
<p><span class="math inline">\(P\)</span> is called a <strong>similarity transformation matrix</strong>.</p>
</div>
<div class="fragment">
<div class="theorem">
<p>If <span class="math inline">\(A\)</span> is similar to <span class="math inline">\(M\)</span>, say <span class="math inline">\(P^{-1} A P=M\)</span>. Then:</p>
<ol type="1">
<li class="fragment"><p>For every polynomial <span class="math inline">\(q(x)\)</span>, <span class="math display">\[
q(M)=P^{-1} q(A) P .
\]</span></p></li>
<li class="fragment"><p>The matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(M\)</span> have the same eigenvalues.</p></li>
</ol>
</div>
</div>
<div class="fragment">
<p>So in particular,</p>
<p><span class="math display">\[
\begin{equation*}
A^{k}=P D^{k} P^{-1}
\end{equation*}
\]</span></p>
</div>
</section>

<section id="diagonalization" class="title-slide slide level2 center">
<h2><em>Diagonalization</em></h2>
<div class="fillin">

</div>
<div class="fillin">

</div>
<aside class="notes">
<p>Suppose we have a <span class="math inline">\(3 \times 3\)</span> matrix <span class="math inline">\(A\)</span></p>
<p>Suppose we then find three linearly independent eigenvectors <span class="math inline">\(\mathbf{v}_{1}, \mathbf{v}_{2}, \mathbf{v}_{3}\)</span></p>
<p><span class="math inline">\(A \mathbf{v}_{1}=\lambda_{1} \mathbf{v}_{1}, A \mathbf{v}_{2}=\lambda_{2} \mathbf{v}_{2}\)</span></p>
<p><span class="math inline">\(A \mathbf{v}_{1}=\lambda_{1} \mathbf{v}_{1}, A \mathbf{v}_{2}=\lambda_{2} \mathbf{v}_{2}\)</span> etc</p>
<p>Put this together: <span class="math display">\[
A\left[\mathbf{v}_{1}, \mathbf{v}_{2}, \mathbf{v}_{3}\right]=\left[\mathbf{v}_{1}, \mathbf{v}_{2}, \mathbf{v}_{3}\right]\left[\begin{array}{ccc}
\lambda_{1} &amp; 0 &amp; 0 \\
0 &amp; \lambda_{2} &amp; 0 \\
0 &amp; 0 &amp; \lambda_{3}
\end{array}\right]=\left[\mathbf{v}_{1}, \mathbf{v}_{2}, \mathbf{v}_{3}\right] \operatorname{diag}\left\{\lambda_{1}, \lambda_{2}, \lambda_{3}\right\}
\]</span></p>
<p>Now define <span class="math inline">\(P=\left[\mathbf{v}_{1}, \mathbf{v}_{2}, \mathbf{v}_{3}\right]\)</span> and <span class="math inline">\(D=\operatorname{diag}\left\{\lambda_{1}, \lambda_{2}, \lambda_{3}\right\}\)</span></p>
<p>Multiply on the right by <span class="math inline">\(P^{-1}\)</span> (can do because columns of <span class="math inline">\(P\)</span> are linearly independent, so it’s invertible):</p>
<p><span class="math inline">\(A P=P D\Rightarrow P^{-1} D P=A\)</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment">
<p>To diagonalize an <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span>, we just need to find <span class="math inline">\(n\)</span> independent eigenvectors and put them into the columns of a matrix <span class="math inline">\(P\)</span>. Then <span class="math inline">\(P^{-1} A P=D\)</span></p>
</div>
</section>

<section id="example-1" class="title-slide slide level2 center">
<h2><em>Example</em></h2>
<p>Find <span class="math inline">\(f(A)\)</span> for <span class="math inline">\(A=\left[\begin{array}{rrr} 2 &amp; 1 &amp; 2 \\0 &amp; 1 &amp; -2 \\0 &amp; 0 &amp; 2\end{array}\right]\)</span> with <span class="math inline">\(f(x)=\sin \left(\frac{\pi}{2} x\right)\)</span></p>
<div class="fragment">
<p>From before, the basis vectors for the eigenspace of <span class="math inline">\(\lambda=2\)</span> are <span class="math inline">\(\{(1,0,0),(0,-2,1)\}\)</span></p>
<p>The basis for the eigenspace of <span class="math inline">\(\lambda=1\)</span> is <span class="math inline">\(\{(-1,1,0)\}\)</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
P=\left[\mathbf{v}_{1}, \mathbf{v}_{2}, \mathbf{v}_{3}\right]=\left[\begin{array}{rrr}
1 &amp; 0 &amp; -1 \\
0 &amp; -2 &amp; 1 \\
0 &amp; 1 &amp; 0
\end{array}\right] .
\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
P^{-1}=\left[\begin{array}{lll}
1 &amp; 1 &amp; 2 \\
0 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 2
\end{array}\right]
\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
P^{-1} A P=\left[\begin{array}{lll}
2 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{array}\right]=D
\]</span></p>
</div>
</section>

<section id="section-1" class="title-slide slide level2 center">
<h2><em></em></h2>
<p><span class="math display">\[
\begin{aligned}
\sin \left(\frac{\pi}{2} A\right)&amp;=P^{-1} \sin \left(\frac{\pi}{2} D\right) P \\[20pt]
&amp;= \left[\begin{array}{rrr}1 &amp; 0 &amp; -1 \\ 0 &amp; -2 &amp; 1 \\ 0 &amp; 1 &amp; 0\end{array}\right]\left[\begin{array}{ccc}\sin \left(2 \frac{\pi}{2}\right) &amp; 0 &amp; 0 \\ 0 &amp; \sin \left(2 \frac{\pi}{2}\right) &amp; 0 \\ 0 &amp; 0 &amp; \sin \left(1 \frac{\pi}{2}\right)\end{array}\right]\left[\begin{array}{lll}1 &amp; 1 &amp; 2 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 2\end{array}\right]\\[10pt]
&amp;=\left[\begin{array}{ccc}0 &amp; -1 &amp; -2 \\ 0 &amp; 1 &amp; 2 \\ 0 &amp; 0 &amp; 0\end{array}\right]
\end{aligned}
\]</span></p>
</section>

<section id="when-are-matrices-diagonalizable" class="title-slide slide level2 center">
<h2><em>When are matrices diagonalizable?</em></h2>
<div class="theorem">
<p>The <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> is diagonalizable if and only if there exists a linearly independent set of eigenvectors <span class="math inline">\(\mathbf{v}_{1}, \mathbf{v}_{2}, \ldots, \mathbf{v}_{n}\)</span> of <span class="math inline">\(A\)</span> <span class="math inline">\(\dots\)</span> in which case <span class="math inline">\(P=\left[\mathbf{v}_{1}, \mathbf{v}_{2}, \ldots, \mathbf{v}_{n}\right]\)</span> is a diagonalizing matrix for <span class="math inline">\(A\)</span>.</p>
</div>
<div class="fragment">
<div class="theorem">
<p>If the <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> has <span class="math inline">\(n\)</span> distinct eigenvalues, then <span class="math inline">\(A\)</span> is diagonalizable.</p>
<div class="fragment">
<p>Caution: Just because the <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> has fewer than <span class="math inline">\(n\)</span> distinct eigenvalues, you may not conclude that it is not diagonalizable.</p>
</div>
</div>
</div>
</section>
</section>
<section>
<section id="application-to-discrete-dynamical-systems" class="title-slide slide level1 center">
<h1><em>Application to Discrete Dynamical Systems</em></h1>

</section>
<section id="diagonalizable-transition-matrices" class="title-slide slide level2 center">
<h2><em>Diagonalizable Transition Matrices</em></h2>
<p>Suppose you have the discrete dynamical system <span class="math display">\[
\mathbf{x}^{(k+1)}=A \mathbf{x}^{(k)}
\]</span></p>
<div class="fragment">
<p>Assume <span class="math inline">\(A\)</span> is diagonalizable, then we can write complete, linearly independent eigenvectors <span class="math inline">\(\mathbf{v}_{1}, \mathbf{v}_{2}, \ldots, \mathbf{v}_{n}\)</span>, with eigenvalues <span class="math inline">\(\lambda_{1}, \lambda_{2}, \ldots, \lambda_{n}\)</span>.</p>
<p>Suppose the eigenvalues are ordered, so that <span class="math inline">\(|\lambda_{1}| \geq|\lambda_{2}| \geq \cdots \geq|\lambda_{n}|\)</span>.</p>
</div>
<div class="fragment">
<div class="fillin">

</div>
<div class="fillin">

</div>
<aside class="notes">
<p>Then the eigenvectors form a basis of <span class="math inline">\(\mathbb{R}^{n}\)</span> (or <span class="math inline">\(\mathbb{C}^{n}\)</span>), so we can express our initial state as a linear combination of the eigenvectors: <span class="math display">\[
\begin{equation*}
\mathbf{x}^{(0)}=c_{1} \mathbf{v}_{1}+c_{2} \mathbf{v}_{2}+\cdots+c_{n} \mathbf{v}_{n}
\end{equation*}
\]</span></p>
<p>Now we know the effect of multiplying by <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
A \mathbf{x}^{(0)} &amp; =A\left(c_{1} \mathbf{v}_{1}+c_{2} \mathbf{v}_{2}+\cdots+c_{n} \mathbf{v}_{n}\right) \\
&amp; =c_{1}\left(A \mathbf{v}_{1}\right)+c_{2}\left(A \mathbf{v}_{2}\right)+\cdots+c_{n}\left(A \mathbf{v}_{n}\right) \\
&amp; =c_{1} \lambda_{1} \mathbf{v}_{1}+c_{2} \lambda_{2} \mathbf{v}_{2}+\cdots+c_{n} \lambda_{n} \mathbf{v}_{n}
\end{aligned}
\]</span></p>
<p>Can do it repeatedly: <span class="math display">\[
\begin{equation*}
\mathbf{x}^{(k)}=c_{1} \lambda_{1}^{k} \mathbf{v}_{1}+c_{2} \lambda_{2}^{k} \mathbf{v}_{2}+\cdots+c_{n} \lambda_{n}^{k} \mathbf{v}_{n}
\end{equation*}
\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>

<section id="spectral-radius-and-dominant-eigenvalue" class="title-slide slide level2 center">
<h2><em>Spectral Radius and Dominant Eigenvalue</em></h2>
<p><span class="math display">\[
\begin{equation*}
\mathbf{x}^{(k)}=c_{1} \lambda_{1}^{k} \mathbf{v}_{1}+c_{2} \lambda_{2}^{k} \mathbf{v}_{2}+\cdots+c_{n} \lambda_{n}^{k} \mathbf{v}_{n}
\end{equation*}
\]</span></p>
<div class="pause">

</div>
<aside class="notes">
<p>What will happen when <span class="math inline">\(\lambda_{1}\)</span> is greater than 1? Equal to one? Less than one? What about the others?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="fragment">
<div class="definition">
<p>The <strong>spectral radius</strong> <span class="math inline">\(\rho(A)\)</span> of a matrix <span class="math inline">\(A\)</span> with eigenvalues <span class="math inline">\(\lambda_{1}, \lambda_{2}, \ldots, \lambda_{n}\)</span> is</p>
<p><span class="math display">\[
\rho(A)=\max \left\{\left|\lambda_{1}\right|,\left|\lambda_{2}\right|, \ldots,\left|\lambda_{n}\right|\right\} .
\]</span></p>
</div>
</div>
<div class="fragment">
<div class="definition">
<p>If <span class="math inline">\(\left|\lambda_{k}\right|=\rho(A)\)</span> and <span class="math inline">\(\lambda_{k}\)</span> is the <strong>only</strong> eigenvalue with this property, then <span class="math inline">\(\lambda_{k}\)</span> is the <strong>dominant eigenvalue</strong> of <span class="math inline">\(A\)</span>.</p>
</div>
</div>
</section>

<section id="implications-of-the-spectral-radius" class="title-slide slide level2 center">
<h2><em>Implications of the Spectral Radius</em></h2>
<div class="theorem">
<p>For <span class="math inline">\(n \times n\)</span> transition matrix <span class="math inline">\(A\)</span>, initial state vector <span class="math inline">\(\mathbf{x}^{(0)}\)</span>:</p>
<div class="fragment">
<ol type="1">
<li class="fragment">If <span class="math inline">\(\rho(A)&lt;1\)</span>, then <span class="math inline">\(\lim _{k \rightarrow \infty} A^{k} \mathbf{x}^{(0)}=\mathbf{0}\)</span>.</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li class="fragment">If <span class="math inline">\(\rho(A)=1\)</span>, then the sequence of norms <span class="math inline">\(\left\{\left\|\mathbf{x}^{(k)}\right\|\right\}_{k=0}^{\infty}\)</span> is bounded.</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li class="fragment">If <span class="math inline">\(\rho(A)=1\)</span> and <span class="math inline">\(\lambda=1\)</span> is the dominant eigenvalue of <span class="math inline">\(A\)</span>, then <span class="math inline">\(\lim _{k \rightarrow \infty} \mathbf{x}^{(k)}\)</span> is an element of <span class="math inline">\(\mathcal{E}_{1}(A)\)</span> – either an eigenvector or <span class="math inline">\(\mathbf{0}\)</span>.</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li class="fragment">If <span class="math inline">\(\rho(A)&gt;1\)</span>, then for some choices of <span class="math inline">\(\mathbf{x}^{(0)}\)</span> we have <span class="math inline">\(\lim _{k \rightarrow \infty}\|\mathbf{x}\|=\infty\)</span></li>
</ol>
</div>
</div>
</section>

<section id="example-2" class="title-slide slide level2 center">
<h2><em>Example</em></h2>
<p>You have too many frogs.</p>
<div class="fragment">
<p>There is a species of bird that eats frogs. (Yay!) Can these help you with your frog problem?</p>
</div>
<div class="fragment">
<p>Let <span class="math inline">\(F_{k}\)</span> and <span class="math inline">\(B_{k}\)</span> be the number of frogs and birds at year <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
B_{k+1} &amp; =0.6 B_{k}+0.4 F_{k}, \\
F_{k+1} &amp; =-r B_{k}+1.4 F_{k},
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(r\)</span> is the rate at which the birds eat the frogs. (Suppose it’s around 0.35).</p>
<div class="pause">

</div>
<aside class="notes">
<p>There are some issues with this model. You can end up with negative frogs. And you can have birds appear from nowhere. But let’s ignore that for now.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<div class="fragment">
<p>Is it a good idea to introduce these birds?</p>
</div>
</section>

<section id="section-2" class="title-slide slide level2 center">
<h2><em></em></h2>
<p>Let the population vector in the <span class="math inline">\(k\)</span> th year be <span class="math inline">\(\mathbf{x}^{(k)}=\left(B_{k}, F_{k}\right)\)</span></p>
<p><span class="math display">\[
\left[\begin{array}{l}
B_{k+1} \\
F_{k+1}
\end{array}\right]=\left[\begin{array}{rr}
0.6 &amp; 0.4 \\
-0.35 &amp; 1.4
\end{array}\right]\left[\begin{array}{l}
B_{k} \\
F_{k}
\end{array}\right]
\]</span></p>
<div class="fragment">
<p>Find eigenvalues and eigenvectors of the transition matrix.</p>
<div id="52fef861" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a>A <span class="op">=</span> np.array([[<span class="fl">0.6</span>, <span class="fl">0.4</span>], [<span class="op">-</span><span class="fl">0.35</span>, <span class="fl">1.4</span>]])</span>
<span id="cb1-3"><a></a>eigvals, eigvecs <span class="op">=</span> np.linalg.eig(A)</span>
<span id="cb1-4"><a></a>eigvals_sorted <span class="op">=</span> np.sort(eigvals)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb1-5"><a></a>eigvecs_sorted <span class="op">=</span> eigvecs[:, np.argsort(eigvals)[::<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb1-6"><a></a><span class="bu">print</span>(<span class="st">'Eigenvalues: '</span> <span class="op">+</span> <span class="bu">str</span>(eigvals_sorted))</span>
<span id="cb1-7"><a></a><span class="bu">print</span>(<span class="st">'Eigenvectors: '</span><span class="op">+</span> <span class="bu">str</span>(eigvecs_sorted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Eigenvalues: [1.14142136 0.85857864]
Eigenvectors: [[-0.59421716 -0.83980458]
 [-0.80430465 -0.54288882]]</code></pre>
</div>
</div>
<div class="pause">

</div>
<p>Check: use Sympy to diagonalize the matrix.</p>
<div id="5b41fb2f" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>D : Matrix([[0.858578643762691, 0], [0, 1.14142135623731]])
P : Matrix([[0.839804577036026, 0.635068381284203], [0.542888821389189, 0.859598960745815]])</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="18">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}0.6 &amp; 0.4\\-0.35 &amp; 1.4\end{matrix}\right]\)</span></p>
</div>
</div>
<aside class="notes">
<p>What this means is that the component of the initial vector which is in the direction of the eigenvector corresponding to the dominant eigenvalue will grow exponentially, while the other component will decay.</p>
<p>Unless we start only with a vector that’s proportional to the second eigenvector, the frog population will explode.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>

<section id="section-3" class="title-slide slide level2 center">
<h2><em></em></h2>
<div id="31e0a2f8" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>x0 <span class="op">=</span> np.array([<span class="dv">100</span>, <span class="dv">10000</span>]) </span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a><span class="kw">def</span> print_iterations(x0, A, n1<span class="op">=</span><span class="dv">10</span>, n2<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb4-4"><a></a>  x <span class="op">=</span> x0</span>
<span id="cb4-5"><a></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb4-6"><a></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n2):</span>
<span id="cb4-7"><a></a>      x <span class="op">=</span> A <span class="op">@</span> x</span>
<span id="cb4-8"><a></a>    <span class="bu">print</span>(x)</span>
<span id="cb4-9"><a></a></span>
<span id="cb4-10"><a></a></span>
<span id="cb4-11"><a></a>print_iterations(x0, A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[ 4060. 13965.]
[ 8022. 18130.]
[12065.2 22574.3]
[16268.84 27381.2 ]
[20713.784 32639.586]
[25484.1048 38445.596 ]
[30668.70128 44904.39772]
[36362.979856 52132.11136 ]
[42670.6324576 60257.9129544]
[49705.54465632 69426.356776  ]</code></pre>
</div>
</div>
</section>

<section id="section-4" class="title-slide slide level2 center">
<h2><em></em></h2>
<p>Different starting points…</p>
<div id="ea1f3a9a" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a>x0 <span class="op">=</span> eigvecs_sorted[<span class="dv">0</span>]<span class="op">*-</span><span class="dv">1000</span></span>
<span id="cb6-2"><a></a>print_iterations(x0, A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[692.45212576 967.75040247]
[ 802.57143644 1112.49231944]
[ 926.53978964 1276.58924446]
[1066.55957157 1462.93601587]
[1225.11014929 1674.81457217]
[1404.99191844 1915.95184879]
[1609.37589058 2190.58541685]
[1841.85970109 2503.53802188]
[2106.5310294  2860.30233525]
[2408.03955174 3267.13740907]</code></pre>
</div>
</div>
</section>

<section id="section-5" class="title-slide slide level2 center">
<h2><em></em></h2>
<p>What if we start with the second eigenvector?</p>
<div id="a1058286" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>x0 <span class="op">=</span> eigvecs_sorted[<span class="dv">1</span>]<span class="op">*-</span><span class="dv">1000</span></span>
<span id="cb8-2"><a></a>print_iterations(x0, A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[699.73831812 478.5377227 ]
[611.25807995 425.04440043]
[536.77260814 381.12183262]
[474.51229793 345.70015282]
[422.98743989 317.90090967]
[380.9528278  297.01566957]
[347.37796451 282.48844767]
[321.42215777 273.90153916]
[302.41391033 270.96439961]
[289.83410604 273.50529084]</code></pre>
</div>
</div>
<div class="fragment">
<p>Looks good so far, doesn’t blow up. But if we continue (only printing results every 10 years now):</p>
<div id="bd284d43" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a>x0 <span class="op">=</span> eigvecs_sorted[<span class="dv">1</span>]<span class="op">*-</span><span class="dv">1000</span></span>
<span id="cb10-2"><a></a>print_iterations(x0, A,n1 <span class="op">=</span> <span class="dv">10</span>, n2 <span class="op">=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[289.83410604 273.50529084]
[493.86429346 642.61221892]
[1724.50444871 2328.57998379]
[6445.12974686 8722.60198143]
[24186.97763221 32738.09888286]
[ 90789.4036837  122888.24713326]
[340796.1924577  461285.82916599]
[1279247.72362158 1731530.09096614]
[4801916.36748821 6499650.17996028]
[18024969.23527191 24397758.22361141]</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Even the roundoff errors are starting to make the frog population explode</p>
</div>
</section>

<section id="what-about-complex-eigenvalues" class="title-slide slide level2 center">
<h2><em>What about complex eigenvalues?</em></h2>
<p>Let’s repeat the above for a different matrix:</p>
<p><span class="math display">\[
\left[\begin{array}{ll}
0 &amp; 2 \\
-2 &amp; 0
\end{array}\right]
\]</span></p>
<div class="fragment">
<div id="53bef8e2" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>A <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>]])</span>
<span id="cb12-2"><a></a>eigvals, eigvecs <span class="op">=</span> np.linalg.eig(A)</span>
<span id="cb12-3"><a></a>eigvals_sorted <span class="op">=</span> np.sort(eigvals)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb12-4"><a></a>eigvecs_sorted <span class="op">=</span> eigvecs[:, np.argsort(eigvals)[::<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb12-5"><a></a><span class="bu">print</span>(<span class="st">'Eigenvalues: '</span> <span class="op">+</span> <span class="bu">str</span>(eigvals_sorted))</span>
<span id="cb12-6"><a></a><span class="bu">print</span>(<span class="st">'Eigenvectors: '</span><span class="op">+</span> <span class="bu">str</span>(eigvecs_sorted))</span>
<span id="cb12-7"><a></a>print_iterations(np.array([<span class="dv">1</span>,<span class="dv">2</span>]), A,n1 <span class="op">=</span> <span class="dv">10</span>, n2 <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Eigenvalues: [0.+2.j 0.-2.j]
Eigenvectors: [[0.        -0.70710678j 0.        +0.70710678j]
 [0.70710678+0.j         0.70710678-0.j        ]]
[ 4 -2]
[-4 -8]
[-16   8]
[16 32]
[ 64 -32]
[ -64 -128]
[-256  128]
[256 512]
[1024 -512]
[-1024 -2048]</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Let’s plot that…</p>
<div id="924fcef8" class="cell" data-fig="true" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-2"><a></a></span>
<span id="cb14-3"><a></a><span class="kw">def</span> plot_iterations(x0, A, n1<span class="op">=</span><span class="dv">10</span>, n2<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb14-4"><a></a>  plt.clf()</span>
<span id="cb14-5"><a></a>  x <span class="op">=</span> x0</span>
<span id="cb14-6"><a></a>  x_vals <span class="op">=</span> [x]</span>
<span id="cb14-7"><a></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb14-8"><a></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n2):</span>
<span id="cb14-9"><a></a>      x <span class="op">=</span> A <span class="op">@</span> x</span>
<span id="cb14-10"><a></a>    x_vals.append(x)</span>
<span id="cb14-11"><a></a>  x_vals <span class="op">=</span> np.array(x_vals)</span>
<span id="cb14-12"><a></a>  plt.plot(x_vals[:,<span class="dv">0</span>], x_vals[:,<span class="dv">1</span>], <span class="st">'o-'</span>,)</span>
<span id="cb14-13"><a></a>  <span class="cf">for</span> i, txt <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">range</span>(<span class="bu">len</span>(x_vals))):</span>
<span id="cb14-14"><a></a>    plt.annotate(txt, (x_vals[i,<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span>, x_vals[i,<span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb14-15"><a></a>  <span class="co">#plt.plot(x_vals[:,0], x_vals[:,1], 'o-')</span></span>
<span id="cb14-16"><a></a>  plt.xlabel(<span class="st">'B'</span>)</span>
<span id="cb14-17"><a></a>  plt.ylabel(<span class="st">'F'</span>)</span>
<span id="cb14-18"><a></a>  plt.title(<span class="st">'Population dynamics: eigenvalues='</span><span class="op">+</span><span class="bu">str</span>(np.linalg.eig(A)[<span class="dv">0</span>]))</span>
<span id="cb14-19"><a></a>  plt.show()</span>
<span id="cb14-20"><a></a></span>
<span id="cb14-21"><a></a>plot_iterations(np.array([<span class="dv">1</span>,<span class="dv">2</span>]), A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="ch5lecture1_files/figure-revealjs/complex_eigenvalues-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="ch5lecture1_files/figure-revealjs/complex_eigenvalues-output-1.png" id="complex_eigenvalues" width="836" height="449"></a></p>
</figure>
</div>
</div>
</div>
</div>
</section>

<section id="your-turn" class="title-slide slide level2 center">
<h2><em>Your turn</em></h2>
<div id="qpyodide-insertion-location-1" class="qpyodide-insertion-class"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
</section>

<section id="section-6" class="title-slide slide level2 center">
<h2><em></em></h2>
<div id="qpyodide-insertion-location-2" class="qpyodide-insertion-class"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
</section>

<section id="section-7" class="title-slide slide level2 center">
<h2><em></em></h2>
<p>Go back to some of the previous examples we’ve used, or that you’ve used in your projects. Work in pairs to find the eigenvalues and eigenvectors of the transition matrix. What do the eigenvalues tell you about the dynamics of the system?</p>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
<div class="reveal-header">
<div class="header-logo">
<img data-src="">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">

</div>
<div class="sb-title">
<p> </p>
</div>
<div id="reveal-subheader" class="sub-title">
<p> </p>
</div>
</div>
<div class="reveal-footer">
<div class="footer-section">
<p> </p>
</div>
</div>
</section>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-tablet-chalkboard/jquery-min.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-tablet-chalkboard/jquery.awesome-cursor.min.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-tablet-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"id":"088c3a9ce7c86f35","secret":null,"url":"https://reveal-multiplex.glitch.me/"},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: true,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: true,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealTabletChalkboard, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script type="module">
    /**
     * Factory function to create different types of cells based on options.
     * @param {Object} cellData - JSON object containing code, id, and options.
     * @returns {BaseCell} Instance of the appropriate cell class.
     */
    globalThis.qpyodideCreateCell = function(cellData) {
        switch (cellData.options.context) {
            case 'interactive':
                return new InteractiveCell(cellData);
            case 'output':
                return new OutputCell(cellData);
            case 'setup':
                return new SetupCell(cellData);
            default:
                return new InteractiveCell(cellData);
                // throw new Error('Invalid cell type specified in options.');
        }
    }  

    /**
     * CellContainer class for managing a collection of cells.
     * @class
     */
    class CellContainer {
        /**
         * Constructor for CellContainer.
         * Initializes an empty array to store cells.
         * @constructor
         */
        constructor() {
            this.cells = [];
        }

        /**
         * Add a cell to the container.
         * @param {BaseCell} cell - Instance of a cell (BaseCell or its subclasses).
         */
        addCell(cell) {
            this.cells.push(cell);
        }

        /**
         * Execute all cells in the container.
         */
        async executeAllCells() {
            for (const cell of this.cells) {
                await cell.executeCode();
            }
        }

        /**
         * Execute all cells in the container.
         */
        async autoRunExecuteAllCells() {
            for (const cell of this.cells) {
                await cell.autoRunExecuteCode();
            }
        }
    }
      

    /**
     * BaseCell class for handling code execution using Pyodide.
     * @class
     */
    class BaseCell {
        /**
         * Constructor for BaseCell.
         * @constructor
         * @param {Object} cellData - JSON object containing code, id, and options.
         */
        constructor(cellData) {
            this.code = cellData.code;
            this.id = cellData.id;
            this.options = cellData.options;
            this.insertionLocation = document.getElementById(`qpyodide-insertion-location-${this.id}`);
            
            // FIX THIS WHEN YOU GET BACK
            // check if a div already exists
            if(document.getElementById(`qpyodide-outside-insertion-location`)==null){
                var outsideInsertionDiv = document.createElement('div');
                outsideInsertionDiv.id='qpyodide-outside-insertion-location';
                outsideInsertionDiv.className='qpyodide-outside-insertion-location';
                document.getElementsByClassName("reveal-viewport")[0].appendChild(outsideInsertionDiv);
                this.outsideInsertionLocation = outsideInsertionDiv
            }

            
            this.executionLock = false;
        }

        cellOptions() {
            // Subclass this? 
            console.log(this.options);
            return this.options;
        }

        /**
         * Execute the Python code using Pyodide.
         * @returns {*} Result of the code execution.
         */
        async executeCode() {
            // Execute code using Pyodide
            const result = getPyodide().runPython(this.code);
            return result;
        }
    };

    /**
     * InteractiveCell class for creating editable code editor with Monaco Editor.
     * @class
     * @extends BaseCell
     */
    class InteractiveCell extends BaseCell {

        /**
         * Constructor for InteractiveCell.
         * @constructor
         * @param {Object} cellData - JSON object containing code, id, and options.
         */
        constructor(cellData) {
            super(cellData);
            this.editor = null;
            this.setupElement();
            this.setupMonacoEditor();
        }

        /**
         * Set up the interactive cell elements
         */
        setupElement() {

            // Create main div element
            var mainDiv = document.createElement('div');
            mainDiv.id = `qpyodide-interactive-area-${this.id}`;
            mainDiv.className = `qpyodide-interactive-area`;
            if (this.options.classes) {
                mainDiv.className += " " + this.options.classes
            }

            // Create outside insertion location div
            var outsideDiv = document.createElement('div');
            outsideDiv.className = `qpyodide-outside-insertion-area`;

            // Add a unique cell identifier that users can customize
            if (this.options.label) {
                mainDiv.setAttribute('data-id', this.options.label);
            }

            // Create toolbar div
            var toolbarDiv = document.createElement('div');
            toolbarDiv.className = 'qpyodide-editor-toolbar';
            toolbarDiv.id = `qpyodide-editor-toolbar-${this.id}`;

            // Create a div to hold the left buttons
            var leftButtonsDiv = document.createElement('div');
            leftButtonsDiv.className = 'qpyodide-editor-toolbar-left-buttons';

            // Create a div to hold the right buttons
            var rightButtonsDiv = document.createElement('div');
            rightButtonsDiv.className = 'qpyodide-editor-toolbar-right-buttons';

            // Create Run Code button
            var runCodeButton = document.createElement('button');
            runCodeButton.className = 'btn btn-default qpyodide-button qpyodide-button-run';
            runCodeButton.disabled = true;
            runCodeButton.type = 'button';
            runCodeButton.id = `qpyodide-button-run-${this.id}`;
            runCodeButton.textContent = '🟡 Loading Pyodide...';
            runCodeButton.title = `Run code (Shift + Enter)`;

            // Append buttons to the leftButtonsDiv
            leftButtonsDiv.appendChild(runCodeButton);





            // Create Reset button
            var resetButton = document.createElement('button');
            resetButton.className = 'btn btn-light btn-xs qpyodide-button qpyodide-button-reset';
            resetButton.type = 'button';
            resetButton.id = `qpyodide-button-reset-${this.id}`;
            resetButton.title = 'Start over';
            resetButton.innerHTML = '<i class="fa-solid fa-arrows-rotate"></i>';

            // Create Popout button

          // Create Zoom button
            var zoomButton = document.createElement('button');
            zoomButton.className = 'btn btn-light btn-xs qpyodide-button qpyodide-button-zoom';
            zoomButton.type = 'button';
            zoomButton.id = `qpyodide-button-zoom-${this.id}`;
            zoomButton.title = 'Zoom code editor';
            zoomButton.innerHTML = '<i class="fa-regular fa-copy"></i>';

            // Create Copy button
            var copyButton = document.createElement('button');
            copyButton.className = 'btn btn-light btn-xs qpyodide-button qpyodide-button-copy';
            copyButton.type = 'button';
            copyButton.id = `qpyodide-button-copy-${this.id}`;
            copyButton.title = 'Copy code';
            copyButton.innerHTML = '<i class="fa-regular fa-copy"></i>';

            // Append buttons to the rightButtonsDiv
            rightButtonsDiv.appendChild(resetButton);
            rightButtonsDiv.appendChild(copyButton);
            rightButtonsDiv.appendChild(zoomButton);

            // Create console area div
            var consoleAreaDiv = document.createElement('div');
            consoleAreaDiv.id = `qpyodide-console-area-${this.id}`;
            consoleAreaDiv.className = 'qpyodide-console-area';

            // Create editor div
            var editorDiv = document.createElement('div');
            editorDiv.id = `qpyodide-editor-${this.id}`;
            editorDiv.className = 'qpyodide-editor';

            // Create output code area div
            var outputCodeAreaDiv = document.createElement('div');
            outputCodeAreaDiv.id = `qpyodide-output-code-area-${this.id}`;
            outputCodeAreaDiv.className = 'qpyodide-output-code-area';
            outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

            // Create pre element inside output code area
            // This preserves whitespace  and is displayed in a fixed-width font
            var preElement = document.createElement('pre');
            preElement.style.visibility = 'hidden';
            outputCodeAreaDiv.appendChild(preElement);

            // Create output graph area div
            var outputGraphAreaDiv = document.createElement('div');
            outputGraphAreaDiv.id = `qpyodide-output-graph-area-${this.id}`;
            outputGraphAreaDiv.className = 'qpyodide-output-graph-area';
            

            if (typeof(Reveal)=="function"){
              const resizeObserver = new ResizeObserver((entries) => {
                for (const entry of entries) {
                  Reveal.layout()
                  console.log("size changed")
                }
              }
              )
              
              resizeObserver.observe(outputGraphAreaDiv);
              resizeObserver.observe(outputCodeAreaDiv);
            }
            // Append buttons to the toolbar
            toolbarDiv.appendChild(leftButtonsDiv);
            toolbarDiv.appendChild(rightButtonsDiv);

            // Append all elements to the main div
            mainDiv.appendChild(toolbarDiv);
            consoleAreaDiv.appendChild(editorDiv);
            consoleAreaDiv.appendChild(outputCodeAreaDiv);
            mainDiv.appendChild(consoleAreaDiv);
            mainDiv.appendChild(outputGraphAreaDiv);

            // Insert the dynamically generated object at the document location.

           this.insertionLocation.appendChild(mainDiv);
            //console.log(this.outsideInsertionLocation)
        }

        /**
         * Set up Monaco Editor for code editing.
         */
        setupMonacoEditor() {

            // Retrieve the previously created document elements
            this.runButton = document.getElementById(`qpyodide-button-run-${this.id}`);
            this.resetButton = document.getElementById(`qpyodide-button-reset-${this.id}`);
            this.copyButton = document.getElementById(`qpyodide-button-copy-${this.id}`);
            this.zoomButton = document.getElementById(`qpyodide-button-zoom-${this.id}`);
            this.editorDiv = document.getElementById(`qpyodide-editor-${this.id}`);
            this.outputCodeDiv = document.getElementById(`qpyodide-output-code-area-${this.id}`);
            this.outputGraphDiv = document.getElementById(`qpyodide-output-graph-area-${this.id}`);
            this.outsideInsertionLocation=document.getElementsByClassName("qpyodide-outside-insertion-location")[0];
            this.InsertionLocation = document.getElementById(`qpyodide-insertion-location-${this.id}`);
            this.mainDiv=document.getElementById(`qpyodide-interactive-area-${this.id}`);
            // Store reference to the object
            var thiz = this;

            // Load the Monaco Editor and create an instance
            require(['vs/editor/editor.main'], function () {
                thiz.editor = monaco.editor.create(
                    thiz.editorDiv, {
                        value: thiz.code,
                        language: 'python',
                        theme: 'vs-light',
                        automaticLayout: true,           // Works wonderfully with RevealJS
                        scrollBeyondLastLine: false,
                        minimap: {
                            enabled: false
                        },
                        fontSize: '17.5pt',              // Bootstrap is 1 rem
                        renderLineHighlight: "none",     // Disable current line highlighting
                        hideCursorInOverviewRuler: true,  // Remove cursor indictor in right hand side scroll bar
                        readOnly: thiz.options['read-only'] ?? false
                    }
                );
            
                // Store the official counter ID to be used in keyboard shortcuts
                thiz.editor.__qpyodideCounter = thiz.id;
            
                // Store the official div container ID
                thiz.editor.__qpyodideEditorId = `qpyodide-editor-${thiz.id}`;
            
                // Store the initial code value and options
                thiz.editor.__qpyodideinitialCode = thiz.code;
                thiz.editor.__qpyodideOptions = thiz.options;
            
                // Set at the model level the preferred end of line (EOL) character to LF.
                // This prevent `\r\n` from being given to the Pyodide engine if the user is on Windows.
                // See details in: https://github.com/coatless/quarto-Pyodide/issues/94
                // Associated error text: 
                // Error: <text>:1:7 unexpected input
            
                // Retrieve the underlying model
                const model = thiz.editor.getModel();
                // Set EOL for the model
                model.setEOL(monaco.editor.EndOfLineSequence.LF);
            
                // Dynamically modify the height of the editor window if new lines are added.
                let ignoreEvent = false;
                const updateHeight = () => {
                const contentHeight = thiz.editor.getContentHeight();
                // We're avoiding a width change
                //editorDiv.style.width = `${width}px`;
                thiz.editorDiv.style.height = `${contentHeight}px`;
                    try {
                        ignoreEvent = true;
                
                        // The key to resizing is this call
                        thiz.editor.layout();
                    } finally {
                        ignoreEvent = false;
                    }
                };
            
                // Helper function to check if selected text is empty
                function isEmptyCodeText(selectedCodeText) {
                    return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
                }
            
                // Registry of keyboard shortcuts that should be re-added to each editor window
                // when focus changes.
                const addPyodideKeyboardShortCutCommands = () => {
                // Add a keydown event listener for Shift+Enter to run all code in cell
                thiz.editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {
                    // Retrieve all text inside the editor
                    thiz.runCode(thiz.editor.getValue());
                });
            
                // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
                thiz.editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {
                        // Get the selected text from the editor
                        const selectedText = thiz.editor.getModel().getValueInRange(thiz.editor.getSelection());
                        // Check if no code is selected
                        if (isEmptyCodeText(selectedText)) {
                            // Obtain the current cursor position
                            let currentPosition = thiz.editor.getPosition();
                            // Retrieve the current line content
                            let currentLine = thiz.editor.getModel().getLineContent(currentPosition.lineNumber);
                    
                            // Propose a new position to move the cursor to
                            let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);
                    
                            // Check if the new position is beyond the last line of the editor
                            if (newPosition.lineNumber > thiz.editor.getModel().getLineCount()) {
                                // Add a new line at the end of the editor
                                thiz.editor.executeEdits("addNewLine", [{
                                range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
                                text: "\n", 
                                forceMoveMarkers: true,
                                }]);
                            }
                            
                            // Run the entire line of code.
                            thiz.runCode(currentLine);
                    
                            // Move cursor to new position
                            thiz.editor.setPosition(newPosition);
                        } else {
                            // Code to run when Ctrl+Enter is pressed with selected code
                            thiz.runCode(selectedText);
                        }
                    });
                }
            
                // Register an on focus event handler for when a code cell is selected to update
                // what keyboard shortcut commands should work.
                // This is a workaround to fix a regression that happened with multiple
                // editor windows since Monaco 0.32.0 
                // https://github.com/microsoft/monaco-editor/issues/2947
                thiz.editor.onDidFocusEditorText(addPyodideKeyboardShortCutCommands);
            
                // Register an on change event for when new code is added to the editor window
                thiz.editor.onDidContentSizeChange(updateHeight);
            
                // Manually re-update height to account for the content we inserted into the call
                updateHeight();
                    
            });

            
            // Add a click event listener to the run button
            thiz.runButton.onclick = function () {
                thiz.runCode(
                    thiz.editor.getValue()
                );
            };
            
            // Add a click event listener to the reset button
            thiz.copyButton.onclick = function () {
                // Retrieve current code data
                const data = thiz.editor.getValue();
                
                // Write code data onto the clipboard.
                navigator.clipboard.writeText(data || "");
            };

            thiz.zoomButton.onclick = function () {
                // Retrieve current code data
                console.log(thiz.mainDiv.parentNode)
                if(thiz.mainDiv.parentNode===thiz.outsideInsertionLocation){
                    console.log(thiz.InsertionLocation)
                    thiz.InsertionLocation.appendChild(thiz.mainDiv)
                    console.log("inserted into main doc")
                    thiz.outsideInsertionLocation.style.display = "none";
                    thiz.editor.EditorOptions.fontSize='17.5px';
                  }  else {
                        console.log("inserted into outside location")
                    thiz.outsideInsertionLocation.appendChild(thiz.mainDiv)
                    thiz.outsideInsertionLocation.style.display = "block";
                    thiz.editor.EditorOptions.fontSize='12px';
              //  thiz.outsideInsertionLocation.appendChild(thiz.mainDiv)

                    }

           //     document.getElementById("")
           //     const data = thiz.editor.getValue();
                
                // Write code data onto the clipboard.
           //     navigator.clipboard.writeText(data || "");
            };
            
            // Add a click event listener to the copy button
            thiz.resetButton.onclick = function () {
                thiz.editor.setValue(thiz.editor.__qpyodideinitialCode);
            };
        }

        disableInteractiveCells() {
            // Enable locking of execution for the cell
            this.executionLock = true;

            // Disallowing execution of other code cells
            document.querySelectorAll(".qpyodide-button-run").forEach((btn) => {
                btn.disabled = true;
            });
        }

        enableInteractiveCells() {
            // Remove locking of execution for the cell
            this.executionLock = false;

            // All execution of other code cells
            document.querySelectorAll(".qpyodide-button-run").forEach((btn) => {
                btn.disabled = false;
            });
        }

        /**
         * Execute the Python code inside the editor.
         */
        async runCode(code) {
            
            // Check if we have an execution lock
            if (this.executeLock) return; 
            
            this.disableInteractiveCells();

            // Force wait procedure
            await mainPyodide;

            // Clear the output stock
            qpyodideResetOutputArray();

            // Generate a new canvas element, avoid attaching until the end
            let graphFigure = document.createElement("figure");
            document.pyodideMplTarget = graphFigure;

            console.log("Running code!");
            // Obtain results from the base class
            try {
                // Always check to see if the user adds new packages
                await mainPyodide.loadPackagesFromImports(code);

                // Process result
                const output = await mainPyodide.runPythonAsync(code);

                // Add output
                qpyodideAddToOutputArray(output, "stdout");
            } catch (err) {
                // Add error message
                qpyodideAddToOutputArray(err, "stderr");
                // TODO: There has to be a way to remove the Pyodide portion of the errors... 
            }

            const result = qpyodideRetrieveOutput();

            // Nullify the output area of content
            this.outputCodeDiv.innerHTML = "";
            this.outputGraphDiv.innerHTML = "";        

            // Design an output object for messages
            const pre = document.createElement("pre");
            if (/\S/.test(result)) {
                // Display results as HTML elements to retain output styling
                const div = document.createElement("div");
                div.innerHTML = result;
                pre.appendChild(div);
            } else {
                // If nothing is present, hide the element.
                pre.style.visibility = "hidden";
            }

            // Add output under interactive div
            this.outputCodeDiv.appendChild(pre);

            // Place the graphics onto the page
            if (graphFigure) {

                if (this.options['fig-cap']) {
                    // Create figcaption element
                    const figcaptionElement = document.createElement('figcaption');
                    figcaptionElement.innerText = this.options['fig-cap'];
                    // Append figcaption to figure
                    graphFigure.appendChild(figcaptionElement);    
                }

                this.outputGraphDiv.appendChild(graphFigure);
            }

            // Re-enable execution
            this.enableInteractiveCells();
        }
    };

    /**
     * OutputCell class for customizing and displaying output.
     * @class
     * @extends BaseCell
     */
    class OutputCell extends BaseCell {
        /**
         * Constructor for OutputCell.
         * @constructor
         * @param {Object} cellData - JSON object containing code, id, and options.
         */
        constructor(cellData) {
          super(cellData);
        }
      
        /**
         * Display customized output on the page.
         * @param {*} output - Result to be displayed.
         */
        displayOutput(output) {
            const results = this.executeCode();
            return results;
        }
      }

    /**
     * SetupCell class for suppressed output.
     * @class
     * @extends BaseCell
     */
    class SetupCell extends BaseCell {
        /**
         * Constructor for SetupCell.
         * @constructor
         * @param {Object} cellData - JSON object containing code, id, and options.
         */
        constructor(cellData) {
            super(cellData);
        }

        /**
         * Execute the Python code without displaying the results.
         */
        runSetupCode() {
            // Execute code without displaying output
            this.executeCode();
        }
    };
    </script>
    <script type="module">
    // Handle cell initialization initialization
    qpyodideCellDetails.map(
        (entry) => {
          // Handle the creation of the element
          qpyodideCreateCell(entry);
        }
      );
    </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","loop":false,"selector":".lightbox","openEffect":"zoom","descPosition":"bottom"});
    window.onload = () => {
      lightboxQuarto.on('slide_before_load', (data) => {
        const { slideIndex, slideNode, slideConfig, player, trigger } = data;
        const href = trigger.getAttribute('href');
        if (href !== null) {
          const imgEl = window.document.querySelector(`a[href="${href}"] img`);
          if (imgEl !== null) {
            const srcAttr = imgEl.getAttribute("src");
            if (srcAttr && srcAttr.startsWith("data:")) {
              slideConfig.href = srcAttr;
            }
          }
        } 
      });

      lightboxQuarto.on('slide_after_load', (data) => {
        const { slideIndex, slideNode, slideConfig, player, trigger } = data;
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(slideNode);
        }
      });

    };
              </script>
    

</body></html>